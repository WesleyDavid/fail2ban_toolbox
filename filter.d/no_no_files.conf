# No one should ever be trying to snatch these files.
#   - Unless you're actually configuring wordpress, etc.
# Filter dependent order of information in http server logs

# `(GET|POST) /+(?:\./)` handles sneaky scenarios:
#   - Multiple slashes: //xmlrpc.php
#   - Directory traversal: /./xmlrpc.php
#   - Combining the two: //./wp-admin/


[Definition]
failregex = ^\S+\s+<HOST>.*"GET /\.env
            ^\S+\s+<HOST>.*"GET /\.git/
            ^\S+\s+<HOST>.*"GET /config\.php
            ^\S+\s+<HOST>.*"GET /wp-config\.php
            ^\S+\s+<HOST>.*"GET /\.htpasswd
            ^\S+\s+<HOST>.*"GET /\.aws/
            ^\S+\s+<HOST>.*"GET .*phpinfo
            ^\S+\s+<HOST>.*"GET .*pi\.php
            ^\S+\s+<HOST>.*"GET .*i\.php
            ^\S+\s+<HOST>.*"GET .*_profiler/
            ^\S+\s+<HOST> .* "(GET|POST) /+(?:\./)*wp-login\.php[^"]*"
            ^\S+\s+<HOST> .* "(GET|POST) /+(?:\./)*xmlrpc\.php[^"]*"
            ^\S+\s+<HOST> .* "(GET|POST) /+(?:\./)*wp-admin/[^"]*"
